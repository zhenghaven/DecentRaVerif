<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
		      <html>
		    <head>
		    <title>ProVerif: process</title>
		    <link rel="stylesheet" href="cssproverif.css">
									   </head>
									 <body>
									 <H1>Process</H1>
<a name=occ1 class="occ">{1}</a> <span class="keyword">let</span> <span class="var">authList0</span>: <span class="type">AuthList</span> = <span class="fun">AuthListInsert</span>(<span class="fun">AuthListNewItem</span>(<span class="fun">HashEnclave</span>(<span class="fun">enclaveDecentSvr</span>),<span class="fun">decentSvrName</span>),<span class="fun">AuthListEmpty</span>) <span class="keyword">in</span><br>
<a name=occ2 class="occ">{2}</a> <span class="keyword">let</span> <span class="var">authList1</span>: <span class="type">AuthList</span> = <span class="fun">AuthListInsert</span>(<span class="fun">AuthListNewItem</span>(<span class="fun">HashEnclave</span>(<span class="fun">enclaveRecv</span>),<span class="fun">enclaveRecvName</span>),<span class="var">authList0</span>) <span class="keyword">in</span><br>
<a name=occ3 class="occ">{3}</a> <span class="keyword">let</span> <span class="var">authList2</span>: <span class="type">AuthList</span> = <span class="fun">AuthListInsert</span>(<span class="fun">AuthListNewItem</span>(<span class="fun">HashEnclave</span>(<span class="fun">enclaveVrfy</span>),<span class="fun">enclaveVrfyName</span>),<span class="var">authList1</span>) <span class="keyword">in</span><br>
<a name=occ4 class="occ">{4}</a> <span class="keyword">let</span> <span class="var">authListA</span>: <span class="type">AuthList</span> = <span class="fun">AuthListInsert</span>(<span class="fun">AuthListNewItem</span>(<span class="fun">HashEnclave</span>(<span class="fun">enclaveD</span>),<span class="fun">enclaveVrfyName</span>),<span class="var">authList2</span>) <span class="keyword">in</span><br>
<a name=occ5 class="occ">{5}</a> <span class="keyword">let</span> <span class="var">revcListA</span>: <span class="type">bitstring</span> = <span class="fun"></span>(<span class="fun">HashEnclave</span>(<span class="fun">enclaveD</span>),<span class="fun">HashEnclave</span>(<span class="fun">enclaveD</span>)) <span class="keyword">in</span><br>
<a name=occ6 class="occ">{6}</a> <span class="keyword">let</span> <span class="var">pub_iasRepSPKey</span>: <span class="type">spkey</span> = <span class="fun">spkgen</span>(<span class="fun">iasRepKeySeed</span>) <span class="keyword">in</span><br>
<a name=occ7 class="occ">{7}</a> <span class="keyword">let</span> <span class="var">pub_encPrvsKey</span>: <span class="type">spkey</span> = <span class="fun">spkgen</span>(<span class="fun">encPrvsKeySeed</span>) <span class="keyword">in</span><br>
(<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ8 class="occ">{8}</a> <span class="keyword">!</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ9 class="occ">{9}</a> <span class="keyword">in</span>(<span class="name">svrIasCh</span>, <span class="var">@15_signedQuote</span>: <span class="type">signature</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ10 class="occ">{10}</a> <span class="keyword">let</span> <span class="var">@15_quoteCheckRes</span>: <span class="type">bool</span> = <span class="fun">checksign</span>(<span class="fun">getmess</span>(<span class="var">@15_signedQuote</span>),<span class="var">pub_encPrvsKey</span>,<span class="var">@15_signedQuote</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ11 class="occ">{11}</a> <span class="keyword">let</span> <span class="fun">EnclaveQuoteSignin</span>(<span class="var">@15_encHash</span>: <span class="type">enclaveHash</span>,<span class="var">@15_appData</span>: <span class="type">bitstring</span>) = <span class="fun">getmess</span>(<span class="var">@15_signedQuote</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ12 class="occ">{12}</a> <span class="keyword">let</span> <span class="var">@15_iasRep</span>: <span class="type">signature</span> = <span class="fun">sign</span>(<span class="fun">IasRep2Signin</span>(<span class="var">@15_quoteCheckRes</span>,<span class="var">@15_encHash</span>,<span class="var">@15_appData</span>),<span class="fun">sskgen</span>(<span class="fun">iasRepKeySeed</span>)) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ13 class="occ">{13}</a> <span class="keyword">out</span>(<span class="name">svrIasCh</span>, <span class="var">@15_iasRep</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ14 class="occ">{14}</a> <span class="keyword">event</span> <span class="fun">IasIssueRep</span>(<span class="fun">iasRepKeySeed</span>,<span class="var">@15_quoteCheckRes</span>,<span class="var">@15_encHash</span>,<span class="var">@15_appData</span>)<br>
) | (<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ15 class="occ">{15}</a> <span class="keyword">!</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ16 class="occ">{16}</a> <span class="keyword">new</span> <span class="name">localRepKey</span>: <span class="type">keyseed</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;(<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ17 class="occ">{17}</a> <span class="keyword">!</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ18 class="occ">{18}</a> <span class="keyword">new</span> <span class="name">decentSvrKeySeed</span>: <span class="type">keyseed</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ19 class="occ">{19}</a> <span class="keyword">new</span> <span class="name">decentSvrEcKey1</span>: <span class="type">ecskey</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ20 class="occ">{20}</a> <span class="keyword">let</span> <span class="var">@18_signedQuote</span>: <span class="type">signature</span> = <span class="fun">sign</span>(<span class="fun">EnclaveQuoteSignin</span>(<span class="fun">HashEnclave</span>(<span class="fun">enclaveDecentSvr</span>),<span class="fun">spkgen</span>(<span class="name">decentSvrKeySeed</span>)),<span class="fun">sskgen</span>(<span class="fun">encPrvsKeySeed</span>)) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ21 class="occ">{21}</a> <span class="keyword">out</span>(<span class="name">svrIasCh</span>, <span class="var">@18_signedQuote</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ22 class="occ">{22}</a> <span class="keyword">in</span>(<span class="name">svrIasCh</span>, <span class="var">@18_iasRep</span>: <span class="type">signature</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ23 class="occ">{23}</a> <span class="keyword">let</span> <span class="fun">IasRep2Signin</span>(=<span class="fun">true</span>,=<span class="fun">HashEnclave</span>(<span class="fun">enclaveDecentSvr</span>),=<span class="fun">spkgen</span>(<span class="name">decentSvrKeySeed</span>)) = <span class="fun">getmess</span>(<span class="var">@18_iasRep</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ24 class="occ">{24}</a> <span class="keyword">if</span> <span class="fun">checksign</span>(<span class="fun">getmess</span>(<span class="var">@18_iasRep</span>),<span class="var">pub_iasRepSPKey</span>,<span class="var">@18_iasRep</span>) <span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ25 class="occ">{25}</a> <span class="keyword">let</span> <span class="var">@18_svrCert</span>: <span class="type">signature</span> = <span class="fun">sign</span>(<span class="fun">DecentSvrSignin</span>(<span class="fun">spkgen</span>(<span class="name">decentSvrKeySeed</span>),<span class="var">@18_iasRep</span>),<span class="fun">sskgen</span>(<span class="name">decentSvrKeySeed</span>)) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ26 class="occ">{26}</a> <span class="keyword">let</span> <span class="var">@18_svrLocAttRep</span>: <span class="type">signature</span> = <span class="fun">sign</span>(<span class="fun">LocAttRep</span>(<span class="fun">false</span>,<span class="fun">DiHeExp</span>(<span class="fun">DiHeValG</span>,<span class="name">decentSvrEcKey1</span>),<span class="fun">HashEnclave</span>(<span class="fun">enclaveDecentSvr</span>),<span class="fun">emptyStr</span>),<span class="fun">sskgen</span>(<span class="name">localRepKey</span>)) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ27 class="occ">{27}</a> <span class="keyword">out</span>(<span class="name">appSvrCh</span>, <span class="var">@18_svrLocAttRep</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ28 class="occ">{28}</a> <span class="keyword">in</span>(<span class="name">appSvrCh</span>, <span class="var">@18_appLocAttRep</span>: <span class="type">signature</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ29 class="occ">{29}</a> <span class="keyword">let</span> <span class="fun">LocAttRep</span>(=<span class="fun">true</span>,<span class="var">@18_appEcPKey</span>: <span class="type">ecpkey</span>,<span class="var">@18_appEncHash</span>: <span class="type">enclaveHash</span>,<span class="var">@18_appAppData</span>: <span class="type">bitstring</span>) = <span class="fun">getmess</span>(<span class="var">@18_appLocAttRep</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ30 class="occ">{30}</a> <span class="keyword">if</span> <span class="fun">checksign</span>(<span class="fun">getmess</span>(<span class="var">@18_appLocAttRep</span>),<span class="fun">spkgen</span>(<span class="name">localRepKey</span>),<span class="var">@18_appLocAttRep</span>) <span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ31 class="occ">{31}</a> <span class="keyword">in</span>(<span class="name">appSvrCh</span>, <span class="var">@18_certSignReqCipher</span>: <span class="type">ciphertext</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ32 class="occ">{32}</a> <span class="keyword">let</span> <span class="var">@18_locChKey</span>: <span class="type">key</span> = <span class="fun">EcDiHeToKey</span>(<span class="fun">DiHeExp</span>(<span class="var">@18_appEcPKey</span>,<span class="name">decentSvrEcKey1</span>)) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ33 class="occ">{33}</a> <span class="keyword">let</span> <span class="var">@18_chNonce0</span>: <span class="type">nonce</span> = <span class="fun">zero_nonce</span> <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ34 class="occ">{34}</a> <span class="keyword">let</span> <span class="var">@18_chNonce1</span>: <span class="type">nonce</span> = <span class="fun">IncrNonce</span>(<span class="var">@18_chNonce0</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ35 class="occ">{35}</a> <span class="keyword">let</span> <span class="fun">sinjbot</span>(<span class="fun"></span>(<span class="var">@18_appSPkey</span>: <span class="type">spkey</span>,<span class="var">@18_auLs</span>: <span class="type">AuthList</span>)) = <span class="fun">dec</span>(<span class="var">@18_certSignReqCipher</span>,<span class="fun"></span>(<span class="fun">false</span>,<span class="var">@18_chNonce0</span>),<span class="var">@18_locChKey</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ36 class="occ">{36}</a> <span class="keyword">event</span> <span class="fun">DecentSvrIssueCert</span>(<span class="fun">enclaveDecentSvr</span>,<span class="var">@18_appEncHash</span>,<span class="name">localRepKey</span>,<span class="var">@18_appSPkey</span>,<span class="var">@18_auLs</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ37 class="occ">{37}</a> <span class="keyword">new</span> <span class="name">@9_r_125</span>: <span class="type">enc_seed</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ38 class="occ">{38}</a> <span class="keyword">out</span>(<span class="name">appSvrCh</span>, <span class="fun">enc_r</span>(<span class="fun"></span>(<span class="var">@18_svrCert</span>,<span class="fun">sign</span>(<span class="fun">DecentAppSignin</span>(<span class="var">@18_appEncHash</span>,<span class="var">@18_appSPkey</span>,<span class="var">@18_auLs</span>),<span class="fun">sskgen</span>(<span class="name">decentSvrKeySeed</span>))),<span class="fun"></span>(<span class="fun">true</span>,<span class="var">@18_chNonce1</span>),<span class="var">@18_locChKey</span>,<span class="name">@9_r_125</span>))<br>
&nbsp;&nbsp;&nbsp;&nbsp;) | (<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ39 class="occ">{39}</a> <span class="keyword">!</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ40 class="occ">{40}</a> <span class="keyword">in</span>(<span class="name">attackCh</span>, <span class="var">someAuls1</span>: <span class="type">AuthList</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ41 class="occ">{41}</a> <span class="keyword">new</span> <span class="name">enclaveRecvKeySeed</span>: <span class="type">keyseed</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ42 class="occ">{42}</a> <span class="keyword">new</span> <span class="name">enclaveRecvEcKey1</span>: <span class="type">ecskey</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ43 class="occ">{43}</a> <span class="keyword">event</span> <span class="fun">DecentAppInit</span>(<span class="fun">enclaveRecv</span>,<span class="fun">spkgen</span>(<span class="name">enclaveRecvKeySeed</span>),<span class="var">someAuls1</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ44 class="occ">{44}</a> <span class="keyword">let</span> <span class="var">@19_appLocAttRep</span>: <span class="type">signature</span> = <span class="fun">sign</span>(<span class="fun">LocAttRep</span>(<span class="fun">true</span>,<span class="fun">DiHeExp</span>(<span class="fun">DiHeValG</span>,<span class="name">enclaveRecvEcKey1</span>),<span class="fun">HashEnclave</span>(<span class="fun">enclaveRecv</span>),<span class="fun">emptyStr</span>),<span class="fun">sskgen</span>(<span class="name">localRepKey</span>)) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ45 class="occ">{45}</a> <span class="keyword">out</span>(<span class="name">appSvrCh</span>, <span class="var">@19_appLocAttRep</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ46 class="occ">{46}</a> <span class="keyword">in</span>(<span class="name">appSvrCh</span>, <span class="var">@19_svrLocAttRep</span>: <span class="type">signature</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ47 class="occ">{47}</a> <span class="keyword">let</span> <span class="fun">LocAttRep</span>(=<span class="fun">false</span>,<span class="var">@19_svrEcPKey</span>: <span class="type">ecpkey</span>,<span class="var">@19_svrEncHash</span>: <span class="type">enclaveHash</span>,<span class="var">@19_svrAppData</span>: <span class="type">bitstring</span>) = <span class="fun">getmess</span>(<span class="var">@19_svrLocAttRep</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ48 class="occ">{48}</a> <span class="keyword">if</span> <span class="fun">checksign</span>(<span class="fun">getmess</span>(<span class="var">@19_svrLocAttRep</span>),<span class="fun">spkgen</span>(<span class="name">localRepKey</span>),<span class="var">@19_svrLocAttRep</span>) <span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ49 class="occ">{49}</a> <span class="keyword">let</span> <span class="var">@19_locChKey</span>: <span class="type">key</span> = <span class="fun">EcDiHeToKey</span>(<span class="fun">DiHeExp</span>(<span class="var">@19_svrEcPKey</span>,<span class="name">enclaveRecvEcKey1</span>)) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ50 class="occ">{50}</a> <span class="keyword">let</span> <span class="var">@19_chNonce0</span>: <span class="type">nonce</span> = <span class="fun">zero_nonce</span> <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ51 class="occ">{51}</a> <span class="keyword">let</span> <span class="var">@19_chNonce1</span>: <span class="type">nonce</span> = <span class="fun">IncrNonce</span>(<span class="var">@19_chNonce0</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ52 class="occ">{52}</a> <span class="keyword">new</span> <span class="name">@9_r_126</span>: <span class="type">enc_seed</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ53 class="occ">{53}</a> <span class="keyword">out</span>(<span class="name">appSvrCh</span>, <span class="fun">enc_r</span>(<span class="fun"></span>(<span class="fun">spkgen</span>(<span class="name">enclaveRecvKeySeed</span>),<span class="var">someAuls1</span>),<span class="fun"></span>(<span class="fun">false</span>,<span class="var">@19_chNonce0</span>),<span class="var">@19_locChKey</span>,<span class="name">@9_r_126</span>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ54 class="occ">{54}</a> <span class="keyword">in</span>(<span class="name">appSvrCh</span>, <span class="var">@19_appCertCipher</span>: <span class="type">ciphertext</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ55 class="occ">{55}</a> <span class="keyword">let</span> <span class="fun">sinjbot</span>(<span class="fun"></span>(<span class="var">@19_svrCert</span>: <span class="type">signature</span>,<span class="var">@19_appCert</span>: <span class="type">signature</span>)) = <span class="fun">dec</span>(<span class="var">@19_appCertCipher</span>,<span class="fun"></span>(<span class="fun">true</span>,<span class="var">@19_chNonce1</span>),<span class="var">@19_locChKey</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ56 class="occ">{56}</a> <span class="keyword">out</span>(<span class="name">recvCh</span>, <span class="fun"></span>(<span class="var">revcListA</span>,<span class="fun">sign</span>(<span class="var">revcListA</span>,<span class="fun">sskgen</span>(<span class="name">enclaveRecvKeySeed</span>)),<span class="var">@19_svrCert</span>,<span class="var">@19_appCert</span>))<br>
&nbsp;&nbsp;&nbsp;&nbsp;) | (<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ57 class="occ">{57}</a> <span class="keyword">!</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ58 class="occ">{58}</a> <span class="keyword">in</span>(<span class="name">attackCh</span>, <span class="var">someAuls2</span>: <span class="type">AuthList</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ59 class="occ">{59}</a> <span class="keyword">new</span> <span class="name">enclaveVrfyEKeySeed</span>: <span class="type">keyseed</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ60 class="occ">{60}</a> <span class="keyword">new</span> <span class="name">enclaveVrfyEEcKey1</span>: <span class="type">ecskey</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ61 class="occ">{61}</a> <span class="keyword">let</span> <span class="var">@19_appLocAttRep_127</span>: <span class="type">signature</span> = <span class="fun">sign</span>(<span class="fun">LocAttRep</span>(<span class="fun">true</span>,<span class="fun">DiHeExp</span>(<span class="fun">DiHeValG</span>,<span class="name">enclaveVrfyEEcKey1</span>),<span class="fun">HashEnclave</span>(<span class="fun">enclaveVrfy</span>),<span class="fun">emptyStr</span>),<span class="fun">sskgen</span>(<span class="name">localRepKey</span>)) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ62 class="occ">{62}</a> <span class="keyword">out</span>(<span class="name">appSvrCh</span>, <span class="var">@19_appLocAttRep_127</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ63 class="occ">{63}</a> <span class="keyword">in</span>(<span class="name">appSvrCh</span>, <span class="var">@19_svrLocAttRep_128</span>: <span class="type">signature</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ64 class="occ">{64}</a> <span class="keyword">let</span> <span class="fun">LocAttRep</span>(=<span class="fun">false</span>,<span class="var">@19_svrEcPKey_129</span>: <span class="type">ecpkey</span>,<span class="var">@19_svrEncHash_130</span>: <span class="type">enclaveHash</span>,<span class="var">@19_svrAppData_131</span>: <span class="type">bitstring</span>) = <span class="fun">getmess</span>(<span class="var">@19_svrLocAttRep_128</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ65 class="occ">{65}</a> <span class="keyword">if</span> <span class="fun">checksign</span>(<span class="fun">getmess</span>(<span class="var">@19_svrLocAttRep_128</span>),<span class="fun">spkgen</span>(<span class="name">localRepKey</span>),<span class="var">@19_svrLocAttRep_128</span>) <span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ66 class="occ">{66}</a> <span class="keyword">let</span> <span class="var">@19_locChKey_132</span>: <span class="type">key</span> = <span class="fun">EcDiHeToKey</span>(<span class="fun">DiHeExp</span>(<span class="var">@19_svrEcPKey_129</span>,<span class="name">enclaveVrfyEEcKey1</span>)) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ67 class="occ">{67}</a> <span class="keyword">let</span> <span class="var">@19_chNonce0_133</span>: <span class="type">nonce</span> = <span class="fun">zero_nonce</span> <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ68 class="occ">{68}</a> <span class="keyword">let</span> <span class="var">@19_chNonce1_134</span>: <span class="type">nonce</span> = <span class="fun">IncrNonce</span>(<span class="var">@19_chNonce0_133</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ69 class="occ">{69}</a> <span class="keyword">new</span> <span class="name">@9_r_135</span>: <span class="type">enc_seed</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ70 class="occ">{70}</a> <span class="keyword">out</span>(<span class="name">appSvrCh</span>, <span class="fun">enc_r</span>(<span class="fun"></span>(<span class="fun">spkgen</span>(<span class="name">enclaveVrfyEKeySeed</span>),<span class="var">someAuls2</span>),<span class="fun"></span>(<span class="fun">false</span>,<span class="var">@19_chNonce0_133</span>),<span class="var">@19_locChKey_132</span>,<span class="name">@9_r_135</span>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ71 class="occ">{71}</a> <span class="keyword">in</span>(<span class="name">appSvrCh</span>, <span class="var">@19_appCertCipher_136</span>: <span class="type">ciphertext</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ72 class="occ">{72}</a> <span class="keyword">let</span> <span class="fun">sinjbot</span>(<span class="fun"></span>(<span class="var">@19_svrCert_137</span>: <span class="type">signature</span>,<span class="var">@19_appCert_138</span>: <span class="type">signature</span>)) = <span class="fun">dec</span>(<span class="var">@19_appCertCipher_136</span>,<span class="fun"></span>(<span class="fun">true</span>,<span class="var">@19_chNonce1_134</span>),<span class="var">@19_locChKey_132</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ73 class="occ">{73}</a> <span class="keyword">in</span>(<span class="name">vrfyCh</span>, <span class="fun"></span>(<span class="var">@19_peerNameSign</span>: <span class="type">signature</span>,<span class="var">@19_peerSvrCert</span>: <span class="type">signature</span>,<span class="var">@19_peerAppCert</span>: <span class="type">signature</span>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ74 class="occ">{74}</a> <span class="keyword">let</span> <span class="fun">DecentSvrSignin</span>(<span class="var">@19_peerSvrSPKey</span>: <span class="type">spkey</span>,<span class="var">@19_peerSvrIasRep</span>: <span class="type">signature</span>) = <span class="fun">getmess</span>(<span class="var">@19_peerSvrCert</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ75 class="occ">{75}</a> <span class="keyword">let</span> <span class="fun">IasRep2Signin</span>(=<span class="fun">true</span>,<span class="var">@19_peerSvrIasEncHash</span>: <span class="type">enclaveHash</span>,=<span class="var">@19_peerSvrSPKey</span>) = <span class="fun">getmess</span>(<span class="var">@19_peerSvrIasRep</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ76 class="occ">{76}</a> <span class="keyword">let</span> <span class="fun">DecentAppSignin</span>(=<span class="fun">HashEnclave</span>(<span class="fun">enclaveE</span>),<span class="var">@19_peerAppSPKey</span>: <span class="type">spkey</span>,<span class="var">@19_peerAppAuLs</span>: <span class="type">AuthList</span>) = <span class="fun">getmess</span>(<span class="var">@19_peerAppCert</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ77 class="occ">{77}</a> <span class="keyword">let</span> <span class="var">@19_peerName</span>: <span class="type">bitstring</span> = <span class="fun">getmess</span>(<span class="var">@19_peerNameSign</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ78 class="occ">{78}</a> <span class="keyword">if</span> <span class="pred">AuthListIsIn</span>(<span class="fun">AuthListNewItem</span>(<span class="var">@19_peerSvrIasEncHash</span>,<span class="fun">decentSvrName</span>),<span class="var">someAuls2</span>) <span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ79 class="occ">{79}</a> <span class="keyword">if</span> (<span class="fun">checksign</span>(<span class="fun">getmess</span>(<span class="var">@19_peerSvrIasRep</span>),<span class="var">pub_iasRepSPKey</span>,<span class="var">@19_peerSvrIasRep</span>) <span class="fun">&amp;&amp;</span> (<span class="fun">checksign</span>(<span class="fun">getmess</span>(<span class="var">@19_peerSvrCert</span>),<span class="var">@19_peerSvrSPKey</span>,<span class="var">@19_peerSvrCert</span>) <span class="fun">&amp;&amp;</span> (<span class="fun">checksign</span>(<span class="fun">getmess</span>(<span class="var">@19_peerAppCert</span>),<span class="var">@19_peerSvrSPKey</span>,<span class="var">@19_peerAppCert</span>) <span class="fun">&amp;&amp;</span> (<span class="fun">checksign</span>(<span class="fun">getmess</span>(<span class="var">@19_peerNameSign</span>),<span class="var">@19_peerAppSPKey</span>,<span class="var">@19_peerNameSign</span>) <span class="fun">&amp;&amp;</span> (<span class="var">someAuls2</span> <span class="fun">=</span> <span class="var">@19_peerAppAuLs</span>))))) <span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ80 class="occ">{80}</a> <span class="keyword">let</span> <span class="var">@19_vPrCert</span>: <span class="type">signature</span> = <span class="fun">sign</span>(<span class="fun">@19_DecentVrfyAppsignin</span>(<span class="fun">enclaveEName</span>,<span class="fun">HashEnclave</span>(<span class="fun">enclaveE</span>),<span class="var">@19_peerAppSPKey</span>,<span class="var">@19_peerAppAuLs</span>),<span class="fun">sskgen</span>(<span class="name">enclaveVrfyEKeySeed</span>)) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ81 class="occ">{81}</a> <span class="keyword">event</span> <span class="fun">DecentVrfyIssueCert</span>(<span class="fun">enclaveVrfy</span>,<span class="var">@19_peerSvrIasEncHash</span>,<span class="fun">enclaveEName</span>,<span class="fun">HashEnclave</span>(<span class="fun">enclaveE</span>),<span class="var">@19_peerAppSPKey</span>,<span class="var">someAuls2</span>,<span class="var">@19_peerAppAuLs</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ82 class="occ">{82}</a> <span class="keyword">out</span>(<span class="name">vrfyCh</span>, <span class="fun"></span>(<span class="var">@19_svrCert_137</span>,<span class="var">@19_appCert_138</span>,<span class="var">@19_vPrCert</span>))<br>
&nbsp;&nbsp;&nbsp;&nbsp;) | (<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ83 class="occ">{83}</a> <span class="keyword">!</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ84 class="occ">{84}</a> <span class="keyword">in</span>(<span class="name">attackCh</span>, <span class="var">someAuls3</span>: <span class="type">AuthList</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ85 class="occ">{85}</a> <span class="keyword">new</span> <span class="name">enclaveEKeySeed</span>: <span class="type">keyseed</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ86 class="occ">{86}</a> <span class="keyword">new</span> <span class="name">enclaveEEcKey1</span>: <span class="type">ecskey</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ87 class="occ">{87}</a> <span class="keyword">new</span> <span class="name">enclaveEEcKey2</span>: <span class="type">ecskey</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ88 class="occ">{88}</a> <span class="keyword">event</span> <span class="fun">DecentAppInit</span>(<span class="fun">enclaveE</span>,<span class="fun">spkgen</span>(<span class="name">enclaveEKeySeed</span>),<span class="var">someAuls3</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ89 class="occ">{89}</a> <span class="keyword">let</span> <span class="var">@19_appLocAttRep_139</span>: <span class="type">signature</span> = <span class="fun">sign</span>(<span class="fun">LocAttRep</span>(<span class="fun">true</span>,<span class="fun">DiHeExp</span>(<span class="fun">DiHeValG</span>,<span class="name">enclaveEEcKey1</span>),<span class="fun">HashEnclave</span>(<span class="fun">enclaveE</span>),<span class="fun">emptyStr</span>),<span class="fun">sskgen</span>(<span class="name">localRepKey</span>)) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ90 class="occ">{90}</a> <span class="keyword">out</span>(<span class="name">appSvrCh</span>, <span class="var">@19_appLocAttRep_139</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ91 class="occ">{91}</a> <span class="keyword">in</span>(<span class="name">appSvrCh</span>, <span class="var">@19_svrLocAttRep_140</span>: <span class="type">signature</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ92 class="occ">{92}</a> <span class="keyword">let</span> <span class="fun">LocAttRep</span>(=<span class="fun">false</span>,<span class="var">@19_svrEcPKey_141</span>: <span class="type">ecpkey</span>,<span class="var">@19_svrEncHash_142</span>: <span class="type">enclaveHash</span>,<span class="var">@19_svrAppData_143</span>: <span class="type">bitstring</span>) = <span class="fun">getmess</span>(<span class="var">@19_svrLocAttRep_140</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ93 class="occ">{93}</a> <span class="keyword">if</span> <span class="fun">checksign</span>(<span class="fun">getmess</span>(<span class="var">@19_svrLocAttRep_140</span>),<span class="fun">spkgen</span>(<span class="name">localRepKey</span>),<span class="var">@19_svrLocAttRep_140</span>) <span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ94 class="occ">{94}</a> <span class="keyword">let</span> <span class="var">@19_locChKey_144</span>: <span class="type">key</span> = <span class="fun">EcDiHeToKey</span>(<span class="fun">DiHeExp</span>(<span class="var">@19_svrEcPKey_141</span>,<span class="name">enclaveEEcKey1</span>)) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ95 class="occ">{95}</a> <span class="keyword">let</span> <span class="var">@19_chNonce0_145</span>: <span class="type">nonce</span> = <span class="fun">zero_nonce</span> <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ96 class="occ">{96}</a> <span class="keyword">let</span> <span class="var">@19_chNonce1_146</span>: <span class="type">nonce</span> = <span class="fun">IncrNonce</span>(<span class="var">@19_chNonce0_145</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ97 class="occ">{97}</a> <span class="keyword">new</span> <span class="name">@9_r_147</span>: <span class="type">enc_seed</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ98 class="occ">{98}</a> <span class="keyword">out</span>(<span class="name">appSvrCh</span>, <span class="fun">enc_r</span>(<span class="fun"></span>(<span class="fun">spkgen</span>(<span class="name">enclaveEKeySeed</span>),<span class="var">someAuls3</span>),<span class="fun"></span>(<span class="fun">false</span>,<span class="var">@19_chNonce0_145</span>),<span class="var">@19_locChKey_144</span>,<span class="name">@9_r_147</span>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ99 class="occ">{99}</a> <span class="keyword">in</span>(<span class="name">appSvrCh</span>, <span class="var">@19_appCertCipher_148</span>: <span class="type">ciphertext</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ100 class="occ">{100}</a> <span class="keyword">let</span> <span class="fun">sinjbot</span>(<span class="fun"></span>(<span class="var">@19_svrCert_149</span>: <span class="type">signature</span>,<span class="var">@19_appCert_150</span>: <span class="type">signature</span>)) = <span class="fun">dec</span>(<span class="var">@19_appCertCipher_148</span>,<span class="fun"></span>(<span class="fun">true</span>,<span class="var">@19_chNonce1_146</span>),<span class="var">@19_locChKey_144</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ101 class="occ">{101}</a> <span class="keyword">event</span> <span class="fun">DecentVrfyAppReqCert</span>(<span class="fun">enclaveE</span>,<span class="fun">spkgen</span>(<span class="name">enclaveEKeySeed</span>),<span class="var">someAuls3</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ102 class="occ">{102}</a> <span class="keyword">out</span>(<span class="name">vrfyCh</span>, <span class="fun"></span>(<span class="fun">sign</span>(<span class="fun">enclaveEName</span>,<span class="fun">sskgen</span>(<span class="name">enclaveEKeySeed</span>)),<span class="var">@19_svrCert_149</span>,<span class="var">@19_appCert_150</span>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ103 class="occ">{103}</a> <span class="keyword">in</span>(<span class="name">vrfyCh</span>, <span class="fun"></span>(<span class="var">@19_vSvrCert</span>: <span class="type">signature</span>,<span class="var">@19_vrfyCert</span>: <span class="type">signature</span>,<span class="var">@19_vAppCert</span>: <span class="type">signature</span>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ104 class="occ">{104}</a> <span class="keyword">in</span>(<span class="name">recvCh</span>, <span class="fun"></span>(<span class="var">@19_reLs</span>: <span class="type">bitstring</span>,<span class="var">@19_reLsSign</span>: <span class="type">signature</span>,<span class="var">@19_recvSvrCert</span>: <span class="type">signature</span>,<span class="var">@19_recvCert</span>: <span class="type">signature</span>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ105 class="occ">{105}</a> <span class="keyword">let</span> <span class="fun">DecentSvrSignin</span>(<span class="var">@19_peerSvrSPKey_151</span>: <span class="type">spkey</span>,<span class="var">@19_peerSvrIasRep_152</span>: <span class="type">signature</span>) = <span class="fun">getmess</span>(<span class="var">@19_recvSvrCert</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ106 class="occ">{106}</a> <span class="keyword">let</span> <span class="fun">IasRep2Signin</span>(=<span class="fun">true</span>,<span class="var">@19_peerSvrIasEncHash_153</span>: <span class="type">enclaveHash</span>,=<span class="var">@19_peerSvrSPKey_151</span>) = <span class="fun">getmess</span>(<span class="var">@19_peerSvrIasRep_152</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ107 class="occ">{107}</a> <span class="keyword">if</span> (<span class="fun">checksign</span>(<span class="fun">getmess</span>(<span class="var">@19_peerSvrIasRep_152</span>),<span class="var">pub_iasRepSPKey</span>,<span class="var">@19_peerSvrIasRep_152</span>) <span class="fun">&amp;&amp;</span> <span class="fun">checksign</span>(<span class="fun">getmess</span>(<span class="var">@19_recvSvrCert</span>),<span class="var">@19_peerSvrSPKey_151</span>,<span class="var">@19_recvSvrCert</span>)) <span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ108 class="occ">{108}</a> <span class="keyword">if</span> <span class="pred">AuthListIsIn</span>(<span class="fun">AuthListNewItem</span>(<span class="var">@19_peerSvrIasEncHash_153</span>,<span class="fun">decentSvrName</span>),<span class="var">someAuls3</span>) <span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ109 class="occ">{109}</a> <span class="keyword">let</span> <span class="fun">DecentAppSignin</span>(<span class="var">@19_peerAppHash</span>: <span class="type">enclaveHash</span>,<span class="var">@19_peerAppSPKey_154</span>: <span class="type">spkey</span>,<span class="var">@19_peerAppAuLs_155</span>: <span class="type">AuthList</span>) = <span class="fun">getmess</span>(<span class="var">@19_recvCert</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ110 class="occ">{110}</a> <span class="keyword">if</span> (<span class="fun">checksign</span>(<span class="fun">getmess</span>(<span class="var">@19_recvCert</span>),<span class="var">@19_peerSvrSPKey_151</span>,<span class="var">@19_recvCert</span>) <span class="fun">&amp;&amp;</span> (<span class="var">someAuls3</span> <span class="fun">=</span> <span class="var">@19_peerAppAuLs_155</span>)) <span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ111 class="occ">{111}</a> <span class="keyword">if</span> <span class="pred">AuthListIsIn</span>(<span class="fun">AuthListNewItem</span>(<span class="var">@19_peerAppHash</span>,<span class="fun">enclaveRecvName</span>),<span class="var">someAuls3</span>) <span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ112 class="occ">{112}</a> <span class="keyword">if</span> <span class="fun">checksign</span>(<span class="var">@19_reLs</span>,<span class="var">@19_peerAppSPKey_154</span>,<span class="var">@19_reLsSign</span>) <span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ113 class="occ">{113}</a> <span class="keyword">event</span> <span class="fun">DecentAppGotRels</span>(<span class="fun">enclaveE</span>,<span class="var">@19_peerAppHash</span>,<span class="var">@19_peerAppAuLs_155</span>,<span class="var">@19_reLs</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ114 class="occ">{114}</a> <span class="keyword">out</span>(<span class="name">peerCh</span>, <span class="fun"></span>(<span class="fun">DiHeExp</span>(<span class="fun">DiHeValG</span>,<span class="name">enclaveEEcKey2</span>),<span class="fun">sign</span>(<span class="fun">DiHeExp</span>(<span class="fun">DiHeValG</span>,<span class="name">enclaveEEcKey2</span>),<span class="fun">sskgen</span>(<span class="name">enclaveEKeySeed</span>)),<span class="var">@19_vSvrCert</span>,<span class="var">@19_vrfyCert</span>,<span class="var">@19_vAppCert</span>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ115 class="occ">{115}</a> <span class="keyword">in</span>(<span class="name">peerCh</span>, <span class="fun"></span>(<span class="var">@19_peerEcPKey</span>: <span class="type">ecpkey</span>,<span class="var">@19_peerEcKeySign</span>: <span class="type">signature</span>,<span class="var">@19_peerSvrCert_156</span>: <span class="type">signature</span>,<span class="var">@19_peerVrfyCert</span>: <span class="type">signature</span>,<span class="var">@19_peerVAppCert</span>: <span class="type">signature</span>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ116 class="occ">{116}</a> <span class="keyword">let</span> <span class="fun">DecentSvrSignin</span>(<span class="var">@19_peerSvrSPKey_157</span>: <span class="type">spkey</span>,<span class="var">@19_peerSvrIasRep_158</span>: <span class="type">signature</span>) = <span class="fun">getmess</span>(<span class="var">@19_peerSvrCert_156</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ117 class="occ">{117}</a> <span class="keyword">let</span> <span class="fun">IasRep2Signin</span>(=<span class="fun">true</span>,<span class="var">@19_peerSvrIasEncHash_159</span>: <span class="type">enclaveHash</span>,=<span class="var">@19_peerSvrSPKey_157</span>) = <span class="fun">getmess</span>(<span class="var">@19_peerSvrIasRep_158</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ118 class="occ">{118}</a> <span class="keyword">let</span> <span class="fun">DecentAppSignin</span>(<span class="var">@19_peerVrfyHash</span>: <span class="type">enclaveHash</span>,<span class="var">@19_peerVrfySPKey</span>: <span class="type">spkey</span>,=<span class="var">someAuls3</span>) = <span class="fun">getmess</span>(<span class="var">@19_peerVrfyCert</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ119 class="occ">{119}</a> <span class="keyword">let</span> <span class="fun">@19_DecentVrfyAppsignin</span>(=<span class="fun">enclaveFName</span>,<span class="var">@19_peerAppHash_160</span>: <span class="type">enclaveHash</span>,<span class="var">@19_peerSPKey</span>: <span class="type">spkey</span>,<span class="var">@19_peerAuLs</span>: <span class="type">AuthList</span>) = <span class="fun">getmess</span>(<span class="var">@19_peerVAppCert</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ120 class="occ">{120}</a> <span class="keyword">let</span> <span class="fun"></span>(<span class="var">@19_revokedEnc1</span>: <span class="type">enclaveHash</span>,<span class="var">@19_revokedEnc2</span>: <span class="type">enclaveHash</span>) = <span class="var">@19_reLs</span> <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ121 class="occ">{121}</a> <span class="keyword">if</span> (<span class="fun">checksign</span>(<span class="fun">getmess</span>(<span class="var">@19_peerSvrIasRep_158</span>),<span class="var">pub_iasRepSPKey</span>,<span class="var">@19_peerSvrIasRep_158</span>) <span class="fun">&amp;&amp;</span> (<span class="fun">checksign</span>(<span class="fun">getmess</span>(<span class="var">@19_peerSvrCert_156</span>),<span class="var">@19_peerSvrSPKey_157</span>,<span class="var">@19_peerSvrCert_156</span>) <span class="fun">&amp;&amp;</span> (<span class="fun">checksign</span>(<span class="fun">getmess</span>(<span class="var">@19_peerVrfyCert</span>),<span class="var">@19_peerSvrSPKey_157</span>,<span class="var">@19_peerVrfyCert</span>) <span class="fun">&amp;&amp;</span> (<span class="fun">checksign</span>(<span class="fun">getmess</span>(<span class="var">@19_peerVAppCert</span>),<span class="var">@19_peerVrfySPKey</span>,<span class="var">@19_peerVAppCert</span>) <span class="fun">&amp;&amp;</span> (<span class="fun">checksign</span>(<span class="var">@19_peerEcPKey</span>,<span class="var">@19_peerSPKey</span>,<span class="var">@19_peerEcKeySign</span>) <span class="fun">&amp;&amp;</span> ((<span class="var">@19_revokedEnc1</span> <span class="fun">&lt;&gt;</span> <span class="var">@19_peerVrfyHash</span>) <span class="fun">&amp;&amp;</span> ((<span class="var">@19_revokedEnc2</span> <span class="fun">&lt;&gt;</span> <span class="var">@19_peerVrfyHash</span>) <span class="fun">&amp;&amp;</span> ((<span class="var">@19_revokedEnc1</span> <span class="fun">&lt;&gt;</span> <span class="var">@19_peerAppHash_160</span>) <span class="fun">&amp;&amp;</span> ((<span class="var">@19_revokedEnc2</span> <span class="fun">&lt;&gt;</span> <span class="var">@19_peerAppHash_160</span>) <span class="fun">&amp;&amp;</span> (<span class="var">someAuls3</span> <span class="fun">=</span> <span class="var">@19_peerAuLs</span>)))))))))) <span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ122 class="occ">{122}</a> <span class="keyword">if</span> <span class="pred">AuthListIsIn</span>(<span class="fun">AuthListNewItem</span>(<span class="var">@19_peerSvrIasEncHash_159</span>,<span class="fun">decentSvrName</span>),<span class="var">someAuls3</span>) <span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ123 class="occ">{123}</a> <span class="keyword">if</span> <span class="pred">AuthListIsIn</span>(<span class="fun">AuthListNewItem</span>(<span class="var">@19_peerVrfyHash</span>,<span class="fun">enclaveVrfyName</span>),<span class="var">someAuls3</span>) <span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ124 class="occ">{124}</a> <span class="keyword">event</span> <span class="fun">DecentAppAccPeer</span>(<span class="fun">enclaveE</span>,<span class="var">@19_peerAppHash_160</span>,<span class="var">@19_peerAuLs</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ125 class="occ">{125}</a> <span class="keyword">in</span>(<span class="name">peerCh</span>, <span class="var">@19_cipherMsg</span>: <span class="type">ciphertext</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ126 class="occ">{126}</a> <span class="keyword">let</span> <span class="var">@19_chKey</span>: <span class="type">key</span> = <span class="fun">EcDiHeToKey</span>(<span class="fun">DiHeExp</span>(<span class="var">@19_peerEcPKey</span>,<span class="name">enclaveEEcKey2</span>)) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ127 class="occ">{127}</a> <span class="keyword">let</span> <span class="var">@19_chNonce0_161</span>: <span class="type">nonce</span> = <span class="fun">zero_nonce</span> <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ128 class="occ">{128}</a> <span class="keyword">let</span> <span class="fun">sinjbot</span>(<span class="var">@19_msg</span>: <span class="type">bitstring</span>) = <span class="fun">dec</span>(<span class="var">@19_cipherMsg</span>,<span class="fun"></span>(<span class="fun">false</span>,<span class="var">@19_chNonce0_161</span>),<span class="var">@19_chKey</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ129 class="occ">{129}</a> <span class="keyword">event</span> <span class="fun">DecentAppGotMsg</span>(<span class="fun">enclaveE</span>,<span class="var">@19_msg</span>)<br>
&nbsp;&nbsp;&nbsp;&nbsp;) | (<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ130 class="occ">{130}</a> <span class="keyword">!</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ131 class="occ">{131}</a> <span class="keyword">new</span> <span class="name">enclaveVrfyFKeySeed</span>: <span class="type">keyseed</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ132 class="occ">{132}</a> <span class="keyword">new</span> <span class="name">enclaveVrfyFEcKey1</span>: <span class="type">ecskey</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ133 class="occ">{133}</a> <span class="keyword">let</span> <span class="var">@19_appLocAttRep_162</span>: <span class="type">signature</span> = <span class="fun">sign</span>(<span class="fun">LocAttRep</span>(<span class="fun">true</span>,<span class="fun">DiHeExp</span>(<span class="fun">DiHeValG</span>,<span class="name">enclaveVrfyFEcKey1</span>),<span class="fun">HashEnclave</span>(<span class="fun">enclaveVrfy</span>),<span class="fun">emptyStr</span>),<span class="fun">sskgen</span>(<span class="name">localRepKey</span>)) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ134 class="occ">{134}</a> <span class="keyword">out</span>(<span class="name">appSvrCh</span>, <span class="var">@19_appLocAttRep_162</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ135 class="occ">{135}</a> <span class="keyword">in</span>(<span class="name">appSvrCh</span>, <span class="var">@19_svrLocAttRep_163</span>: <span class="type">signature</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ136 class="occ">{136}</a> <span class="keyword">let</span> <span class="fun">LocAttRep</span>(=<span class="fun">false</span>,<span class="var">@19_svrEcPKey_164</span>: <span class="type">ecpkey</span>,<span class="var">@19_svrEncHash_165</span>: <span class="type">enclaveHash</span>,<span class="var">@19_svrAppData_166</span>: <span class="type">bitstring</span>) = <span class="fun">getmess</span>(<span class="var">@19_svrLocAttRep_163</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ137 class="occ">{137}</a> <span class="keyword">if</span> <span class="fun">checksign</span>(<span class="fun">getmess</span>(<span class="var">@19_svrLocAttRep_163</span>),<span class="fun">spkgen</span>(<span class="name">localRepKey</span>),<span class="var">@19_svrLocAttRep_163</span>) <span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ138 class="occ">{138}</a> <span class="keyword">let</span> <span class="var">@19_locChKey_167</span>: <span class="type">key</span> = <span class="fun">EcDiHeToKey</span>(<span class="fun">DiHeExp</span>(<span class="var">@19_svrEcPKey_164</span>,<span class="name">enclaveVrfyFEcKey1</span>)) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ139 class="occ">{139}</a> <span class="keyword">let</span> <span class="var">@19_chNonce0_168</span>: <span class="type">nonce</span> = <span class="fun">zero_nonce</span> <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ140 class="occ">{140}</a> <span class="keyword">let</span> <span class="var">@19_chNonce1_169</span>: <span class="type">nonce</span> = <span class="fun">IncrNonce</span>(<span class="var">@19_chNonce0_168</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ141 class="occ">{141}</a> <span class="keyword">new</span> <span class="name">@9_r_170</span>: <span class="type">enc_seed</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ142 class="occ">{142}</a> <span class="keyword">out</span>(<span class="name">appSvrCh</span>, <span class="fun">enc_r</span>(<span class="fun"></span>(<span class="fun">spkgen</span>(<span class="name">enclaveVrfyFKeySeed</span>),<span class="var">authListA</span>),<span class="fun"></span>(<span class="fun">false</span>,<span class="var">@19_chNonce0_168</span>),<span class="var">@19_locChKey_167</span>,<span class="name">@9_r_170</span>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ143 class="occ">{143}</a> <span class="keyword">in</span>(<span class="name">appSvrCh</span>, <span class="var">@19_appCertCipher_171</span>: <span class="type">ciphertext</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ144 class="occ">{144}</a> <span class="keyword">let</span> <span class="fun">sinjbot</span>(<span class="fun"></span>(<span class="var">@19_svrCert_172</span>: <span class="type">signature</span>,<span class="var">@19_appCert_173</span>: <span class="type">signature</span>)) = <span class="fun">dec</span>(<span class="var">@19_appCertCipher_171</span>,<span class="fun"></span>(<span class="fun">true</span>,<span class="var">@19_chNonce1_169</span>),<span class="var">@19_locChKey_167</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ145 class="occ">{145}</a> <span class="keyword">in</span>(<span class="name">vrfyCh</span>, <span class="fun"></span>(<span class="var">@19_peerNameSign_174</span>: <span class="type">signature</span>,<span class="var">@19_peerSvrCert_175</span>: <span class="type">signature</span>,<span class="var">@19_peerAppCert_176</span>: <span class="type">signature</span>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ146 class="occ">{146}</a> <span class="keyword">let</span> <span class="fun">DecentSvrSignin</span>(<span class="var">@19_peerSvrSPKey_177</span>: <span class="type">spkey</span>,<span class="var">@19_peerSvrIasRep_178</span>: <span class="type">signature</span>) = <span class="fun">getmess</span>(<span class="var">@19_peerSvrCert_175</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ147 class="occ">{147}</a> <span class="keyword">let</span> <span class="fun">IasRep2Signin</span>(=<span class="fun">true</span>,<span class="var">@19_peerSvrIasEncHash_179</span>: <span class="type">enclaveHash</span>,=<span class="var">@19_peerSvrSPKey_177</span>) = <span class="fun">getmess</span>(<span class="var">@19_peerSvrIasRep_178</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ148 class="occ">{148}</a> <span class="keyword">let</span> <span class="fun">DecentAppSignin</span>(=<span class="fun">HashEnclave</span>(<span class="fun">enclaveF</span>),<span class="var">@19_peerAppSPKey_180</span>: <span class="type">spkey</span>,<span class="var">@19_peerAppAuLs_181</span>: <span class="type">AuthList</span>) = <span class="fun">getmess</span>(<span class="var">@19_peerAppCert_176</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ149 class="occ">{149}</a> <span class="keyword">let</span> <span class="var">@19_peerName_182</span>: <span class="type">bitstring</span> = <span class="fun">getmess</span>(<span class="var">@19_peerNameSign_174</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ150 class="occ">{150}</a> <span class="keyword">if</span> <span class="pred">AuthListIsIn</span>(<span class="fun">AuthListNewItem</span>(<span class="var">@19_peerSvrIasEncHash_179</span>,<span class="fun">decentSvrName</span>),<span class="var">authListA</span>) <span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ151 class="occ">{151}</a> <span class="keyword">if</span> (<span class="fun">checksign</span>(<span class="fun">getmess</span>(<span class="var">@19_peerSvrIasRep_178</span>),<span class="var">pub_iasRepSPKey</span>,<span class="var">@19_peerSvrIasRep_178</span>) <span class="fun">&amp;&amp;</span> (<span class="fun">checksign</span>(<span class="fun">getmess</span>(<span class="var">@19_peerSvrCert_175</span>),<span class="var">@19_peerSvrSPKey_177</span>,<span class="var">@19_peerSvrCert_175</span>) <span class="fun">&amp;&amp;</span> (<span class="fun">checksign</span>(<span class="fun">getmess</span>(<span class="var">@19_peerAppCert_176</span>),<span class="var">@19_peerSvrSPKey_177</span>,<span class="var">@19_peerAppCert_176</span>) <span class="fun">&amp;&amp;</span> (<span class="fun">checksign</span>(<span class="fun">getmess</span>(<span class="var">@19_peerNameSign_174</span>),<span class="var">@19_peerAppSPKey_180</span>,<span class="var">@19_peerNameSign_174</span>) <span class="fun">&amp;&amp;</span> (<span class="var">authListA</span> <span class="fun">=</span> <span class="var">@19_peerAppAuLs_181</span>))))) <span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ152 class="occ">{152}</a> <span class="keyword">let</span> <span class="var">@19_vPrCert_183</span>: <span class="type">signature</span> = <span class="fun">sign</span>(<span class="fun">@19_DecentVrfyAppsignin</span>(<span class="fun">enclaveFName</span>,<span class="fun">HashEnclave</span>(<span class="fun">enclaveF</span>),<span class="var">@19_peerAppSPKey_180</span>,<span class="var">@19_peerAppAuLs_181</span>),<span class="fun">sskgen</span>(<span class="name">enclaveVrfyFKeySeed</span>)) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ153 class="occ">{153}</a> <span class="keyword">event</span> <span class="fun">DecentVrfyIssueCert</span>(<span class="fun">enclaveVrfy</span>,<span class="var">@19_peerSvrIasEncHash_179</span>,<span class="fun">enclaveFName</span>,<span class="fun">HashEnclave</span>(<span class="fun">enclaveF</span>),<span class="var">@19_peerAppSPKey_180</span>,<span class="var">authListA</span>,<span class="var">@19_peerAppAuLs_181</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ154 class="occ">{154}</a> <span class="keyword">out</span>(<span class="name">vrfyCh</span>, <span class="fun"></span>(<span class="var">@19_svrCert_172</span>,<span class="var">@19_appCert_173</span>,<span class="var">@19_vPrCert_183</span>))<br>
&nbsp;&nbsp;&nbsp;&nbsp;) | (<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ155 class="occ">{155}</a> <span class="keyword">!</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ156 class="occ">{156}</a> <span class="keyword">new</span> <span class="name">enclaveFKeySeed</span>: <span class="type">keyseed</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ157 class="occ">{157}</a> <span class="keyword">new</span> <span class="name">enclaveFEcKey1</span>: <span class="type">ecskey</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ158 class="occ">{158}</a> <span class="keyword">new</span> <span class="name">enclaveFEcKey2</span>: <span class="type">ecskey</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ159 class="occ">{159}</a> <span class="keyword">event</span> <span class="fun">DecentAppInit</span>(<span class="fun">enclaveF</span>,<span class="fun">spkgen</span>(<span class="name">enclaveFKeySeed</span>),<span class="var">authListA</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ160 class="occ">{160}</a> <span class="keyword">let</span> <span class="var">@19_appLocAttRep_184</span>: <span class="type">signature</span> = <span class="fun">sign</span>(<span class="fun">LocAttRep</span>(<span class="fun">true</span>,<span class="fun">DiHeExp</span>(<span class="fun">DiHeValG</span>,<span class="name">enclaveFEcKey1</span>),<span class="fun">HashEnclave</span>(<span class="fun">enclaveF</span>),<span class="fun">emptyStr</span>),<span class="fun">sskgen</span>(<span class="name">localRepKey</span>)) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ161 class="occ">{161}</a> <span class="keyword">out</span>(<span class="name">appSvrCh</span>, <span class="var">@19_appLocAttRep_184</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ162 class="occ">{162}</a> <span class="keyword">in</span>(<span class="name">appSvrCh</span>, <span class="var">@19_svrLocAttRep_185</span>: <span class="type">signature</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ163 class="occ">{163}</a> <span class="keyword">let</span> <span class="fun">LocAttRep</span>(=<span class="fun">false</span>,<span class="var">@19_svrEcPKey_186</span>: <span class="type">ecpkey</span>,<span class="var">@19_svrEncHash_187</span>: <span class="type">enclaveHash</span>,<span class="var">@19_svrAppData_188</span>: <span class="type">bitstring</span>) = <span class="fun">getmess</span>(<span class="var">@19_svrLocAttRep_185</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ164 class="occ">{164}</a> <span class="keyword">if</span> <span class="fun">checksign</span>(<span class="fun">getmess</span>(<span class="var">@19_svrLocAttRep_185</span>),<span class="fun">spkgen</span>(<span class="name">localRepKey</span>),<span class="var">@19_svrLocAttRep_185</span>) <span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ165 class="occ">{165}</a> <span class="keyword">let</span> <span class="var">@19_locChKey_189</span>: <span class="type">key</span> = <span class="fun">EcDiHeToKey</span>(<span class="fun">DiHeExp</span>(<span class="var">@19_svrEcPKey_186</span>,<span class="name">enclaveFEcKey1</span>)) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ166 class="occ">{166}</a> <span class="keyword">let</span> <span class="var">@19_chNonce0_190</span>: <span class="type">nonce</span> = <span class="fun">zero_nonce</span> <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ167 class="occ">{167}</a> <span class="keyword">let</span> <span class="var">@19_chNonce1_191</span>: <span class="type">nonce</span> = <span class="fun">IncrNonce</span>(<span class="var">@19_chNonce0_190</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ168 class="occ">{168}</a> <span class="keyword">new</span> <span class="name">@9_r_192</span>: <span class="type">enc_seed</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ169 class="occ">{169}</a> <span class="keyword">out</span>(<span class="name">appSvrCh</span>, <span class="fun">enc_r</span>(<span class="fun"></span>(<span class="fun">spkgen</span>(<span class="name">enclaveFKeySeed</span>),<span class="var">authListA</span>),<span class="fun"></span>(<span class="fun">false</span>,<span class="var">@19_chNonce0_190</span>),<span class="var">@19_locChKey_189</span>,<span class="name">@9_r_192</span>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ170 class="occ">{170}</a> <span class="keyword">in</span>(<span class="name">appSvrCh</span>, <span class="var">@19_appCertCipher_193</span>: <span class="type">ciphertext</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ171 class="occ">{171}</a> <span class="keyword">let</span> <span class="fun">sinjbot</span>(<span class="fun"></span>(<span class="var">@19_svrCert_194</span>: <span class="type">signature</span>,<span class="var">@19_appCert_195</span>: <span class="type">signature</span>)) = <span class="fun">dec</span>(<span class="var">@19_appCertCipher_193</span>,<span class="fun"></span>(<span class="fun">true</span>,<span class="var">@19_chNonce1_191</span>),<span class="var">@19_locChKey_189</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ172 class="occ">{172}</a> <span class="keyword">event</span> <span class="fun">DecentVrfyAppReqCert</span>(<span class="fun">enclaveF</span>,<span class="fun">spkgen</span>(<span class="name">enclaveFKeySeed</span>),<span class="var">authListA</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ173 class="occ">{173}</a> <span class="keyword">out</span>(<span class="name">vrfyCh</span>, <span class="fun"></span>(<span class="fun">sign</span>(<span class="fun">enclaveFName</span>,<span class="fun">sskgen</span>(<span class="name">enclaveFKeySeed</span>)),<span class="var">@19_svrCert_194</span>,<span class="var">@19_appCert_195</span>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ174 class="occ">{174}</a> <span class="keyword">in</span>(<span class="name">vrfyCh</span>, <span class="fun"></span>(<span class="var">@19_vSvrCert_196</span>: <span class="type">signature</span>,<span class="var">@19_vrfyCert_197</span>: <span class="type">signature</span>,<span class="var">@19_vAppCert_198</span>: <span class="type">signature</span>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ175 class="occ">{175}</a> <span class="keyword">in</span>(<span class="name">recvCh</span>, <span class="fun"></span>(<span class="var">@19_reLs_199</span>: <span class="type">bitstring</span>,<span class="var">@19_reLsSign_200</span>: <span class="type">signature</span>,<span class="var">@19_recvSvrCert_201</span>: <span class="type">signature</span>,<span class="var">@19_recvCert_202</span>: <span class="type">signature</span>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ176 class="occ">{176}</a> <span class="keyword">let</span> <span class="fun">DecentSvrSignin</span>(<span class="var">@19_peerSvrSPKey_203</span>: <span class="type">spkey</span>,<span class="var">@19_peerSvrIasRep_204</span>: <span class="type">signature</span>) = <span class="fun">getmess</span>(<span class="var">@19_recvSvrCert_201</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ177 class="occ">{177}</a> <span class="keyword">let</span> <span class="fun">IasRep2Signin</span>(=<span class="fun">true</span>,<span class="var">@19_peerSvrIasEncHash_205</span>: <span class="type">enclaveHash</span>,=<span class="var">@19_peerSvrSPKey_203</span>) = <span class="fun">getmess</span>(<span class="var">@19_peerSvrIasRep_204</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ178 class="occ">{178}</a> <span class="keyword">if</span> (<span class="fun">checksign</span>(<span class="fun">getmess</span>(<span class="var">@19_peerSvrIasRep_204</span>),<span class="var">pub_iasRepSPKey</span>,<span class="var">@19_peerSvrIasRep_204</span>) <span class="fun">&amp;&amp;</span> <span class="fun">checksign</span>(<span class="fun">getmess</span>(<span class="var">@19_recvSvrCert_201</span>),<span class="var">@19_peerSvrSPKey_203</span>,<span class="var">@19_recvSvrCert_201</span>)) <span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ179 class="occ">{179}</a> <span class="keyword">if</span> <span class="pred">AuthListIsIn</span>(<span class="fun">AuthListNewItem</span>(<span class="var">@19_peerSvrIasEncHash_205</span>,<span class="fun">decentSvrName</span>),<span class="var">authListA</span>) <span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ180 class="occ">{180}</a> <span class="keyword">let</span> <span class="fun">DecentAppSignin</span>(<span class="var">@19_peerAppHash_206</span>: <span class="type">enclaveHash</span>,<span class="var">@19_peerAppSPKey_207</span>: <span class="type">spkey</span>,<span class="var">@19_peerAppAuLs_208</span>: <span class="type">AuthList</span>) = <span class="fun">getmess</span>(<span class="var">@19_recvCert_202</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ181 class="occ">{181}</a> <span class="keyword">if</span> (<span class="fun">checksign</span>(<span class="fun">getmess</span>(<span class="var">@19_recvCert_202</span>),<span class="var">@19_peerSvrSPKey_203</span>,<span class="var">@19_recvCert_202</span>) <span class="fun">&amp;&amp;</span> (<span class="var">authListA</span> <span class="fun">=</span> <span class="var">@19_peerAppAuLs_208</span>)) <span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ182 class="occ">{182}</a> <span class="keyword">if</span> <span class="pred">AuthListIsIn</span>(<span class="fun">AuthListNewItem</span>(<span class="var">@19_peerAppHash_206</span>,<span class="fun">enclaveRecvName</span>),<span class="var">authListA</span>) <span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ183 class="occ">{183}</a> <span class="keyword">if</span> <span class="fun">checksign</span>(<span class="var">@19_reLs_199</span>,<span class="var">@19_peerAppSPKey_207</span>,<span class="var">@19_reLsSign_200</span>) <span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ184 class="occ">{184}</a> <span class="keyword">event</span> <span class="fun">DecentAppGotRels</span>(<span class="fun">enclaveF</span>,<span class="var">@19_peerAppHash_206</span>,<span class="var">@19_peerAppAuLs_208</span>,<span class="var">@19_reLs_199</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ185 class="occ">{185}</a> <span class="keyword">out</span>(<span class="name">peerCh</span>, <span class="fun"></span>(<span class="fun">DiHeExp</span>(<span class="fun">DiHeValG</span>,<span class="name">enclaveFEcKey2</span>),<span class="fun">sign</span>(<span class="fun">DiHeExp</span>(<span class="fun">DiHeValG</span>,<span class="name">enclaveFEcKey2</span>),<span class="fun">sskgen</span>(<span class="name">enclaveFKeySeed</span>)),<span class="var">@19_vSvrCert_196</span>,<span class="var">@19_vrfyCert_197</span>,<span class="var">@19_vAppCert_198</span>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ186 class="occ">{186}</a> <span class="keyword">in</span>(<span class="name">peerCh</span>, <span class="fun"></span>(<span class="var">@19_peerEcPKey_209</span>: <span class="type">ecpkey</span>,<span class="var">@19_peerEcKeySign_210</span>: <span class="type">signature</span>,<span class="var">@19_peerSvrCert_211</span>: <span class="type">signature</span>,<span class="var">@19_peerVrfyCert_212</span>: <span class="type">signature</span>,<span class="var">@19_peerVAppCert_213</span>: <span class="type">signature</span>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ187 class="occ">{187}</a> <span class="keyword">let</span> <span class="fun">DecentSvrSignin</span>(<span class="var">@19_peerSvrSPKey_214</span>: <span class="type">spkey</span>,<span class="var">@19_peerSvrIasRep_215</span>: <span class="type">signature</span>) = <span class="fun">getmess</span>(<span class="var">@19_peerSvrCert_211</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ188 class="occ">{188}</a> <span class="keyword">let</span> <span class="fun">IasRep2Signin</span>(=<span class="fun">true</span>,<span class="var">@19_peerSvrIasEncHash_216</span>: <span class="type">enclaveHash</span>,=<span class="var">@19_peerSvrSPKey_214</span>) = <span class="fun">getmess</span>(<span class="var">@19_peerSvrIasRep_215</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ189 class="occ">{189}</a> <span class="keyword">let</span> <span class="fun">DecentAppSignin</span>(<span class="var">@19_peerVrfyHash_217</span>: <span class="type">enclaveHash</span>,<span class="var">@19_peerVrfySPKey_218</span>: <span class="type">spkey</span>,=<span class="var">authListA</span>) = <span class="fun">getmess</span>(<span class="var">@19_peerVrfyCert_212</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ190 class="occ">{190}</a> <span class="keyword">let</span> <span class="fun">@19_DecentVrfyAppsignin</span>(=<span class="fun">enclaveEName</span>,<span class="var">@19_peerAppHash_219</span>: <span class="type">enclaveHash</span>,<span class="var">@19_peerSPKey_220</span>: <span class="type">spkey</span>,<span class="var">@19_peerAuLs_221</span>: <span class="type">AuthList</span>) = <span class="fun">getmess</span>(<span class="var">@19_peerVAppCert_213</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ191 class="occ">{191}</a> <span class="keyword">let</span> <span class="fun"></span>(<span class="var">@19_revokedEnc1_222</span>: <span class="type">enclaveHash</span>,<span class="var">@19_revokedEnc2_223</span>: <span class="type">enclaveHash</span>) = <span class="var">@19_reLs_199</span> <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ192 class="occ">{192}</a> <span class="keyword">if</span> (<span class="fun">checksign</span>(<span class="fun">getmess</span>(<span class="var">@19_peerSvrIasRep_215</span>),<span class="var">pub_iasRepSPKey</span>,<span class="var">@19_peerSvrIasRep_215</span>) <span class="fun">&amp;&amp;</span> (<span class="fun">checksign</span>(<span class="fun">getmess</span>(<span class="var">@19_peerSvrCert_211</span>),<span class="var">@19_peerSvrSPKey_214</span>,<span class="var">@19_peerSvrCert_211</span>) <span class="fun">&amp;&amp;</span> (<span class="fun">checksign</span>(<span class="fun">getmess</span>(<span class="var">@19_peerVrfyCert_212</span>),<span class="var">@19_peerSvrSPKey_214</span>,<span class="var">@19_peerVrfyCert_212</span>) <span class="fun">&amp;&amp;</span> (<span class="fun">checksign</span>(<span class="fun">getmess</span>(<span class="var">@19_peerVAppCert_213</span>),<span class="var">@19_peerVrfySPKey_218</span>,<span class="var">@19_peerVAppCert_213</span>) <span class="fun">&amp;&amp;</span> (<span class="fun">checksign</span>(<span class="var">@19_peerEcPKey_209</span>,<span class="var">@19_peerSPKey_220</span>,<span class="var">@19_peerEcKeySign_210</span>) <span class="fun">&amp;&amp;</span> ((<span class="var">@19_revokedEnc1_222</span> <span class="fun">&lt;&gt;</span> <span class="var">@19_peerVrfyHash_217</span>) <span class="fun">&amp;&amp;</span> ((<span class="var">@19_revokedEnc2_223</span> <span class="fun">&lt;&gt;</span> <span class="var">@19_peerVrfyHash_217</span>) <span class="fun">&amp;&amp;</span> ((<span class="var">@19_revokedEnc1_222</span> <span class="fun">&lt;&gt;</span> <span class="var">@19_peerAppHash_219</span>) <span class="fun">&amp;&amp;</span> ((<span class="var">@19_revokedEnc2_223</span> <span class="fun">&lt;&gt;</span> <span class="var">@19_peerAppHash_219</span>) <span class="fun">&amp;&amp;</span> (<span class="var">authListA</span> <span class="fun">=</span> <span class="var">@19_peerAuLs_221</span>)))))))))) <span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ193 class="occ">{193}</a> <span class="keyword">if</span> <span class="pred">AuthListIsIn</span>(<span class="fun">AuthListNewItem</span>(<span class="var">@19_peerSvrIasEncHash_216</span>,<span class="fun">decentSvrName</span>),<span class="var">authListA</span>) <span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ194 class="occ">{194}</a> <span class="keyword">if</span> <span class="pred">AuthListIsIn</span>(<span class="fun">AuthListNewItem</span>(<span class="var">@19_peerVrfyHash_217</span>,<span class="fun">enclaveVrfyName</span>),<span class="var">authListA</span>) <span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ195 class="occ">{195}</a> <span class="keyword">event</span> <span class="fun">DecentAppAccPeer</span>(<span class="fun">enclaveF</span>,<span class="var">@19_peerAppHash_219</span>,<span class="var">@19_peerAuLs_221</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ196 class="occ">{196}</a> <span class="keyword">let</span> <span class="var">@19_chKey_224</span>: <span class="type">key</span> = <span class="fun">EcDiHeToKey</span>(<span class="fun">DiHeExp</span>(<span class="var">@19_peerEcPKey_209</span>,<span class="name">enclaveFEcKey2</span>)) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ197 class="occ">{197}</a> <span class="keyword">let</span> <span class="var">@19_chNonce0_225</span>: <span class="type">nonce</span> = <span class="fun">zero_nonce</span> <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ198 class="occ">{198}</a> <span class="keyword">new</span> <span class="name">@9_r_226</span>: <span class="type">enc_seed</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ199 class="occ">{199}</a> <span class="keyword">out</span>(<span class="name">peerCh</span>, <span class="fun">enc_r</span>(<span class="fun">secret_msg</span>,<span class="fun"></span>(<span class="fun">false</span>,<span class="var">@19_chNonce0_225</span>),<span class="var">@19_chKey_224</span>,<span class="name">@9_r_226</span>))<br>
&nbsp;&nbsp;&nbsp;&nbsp;) | (<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ200 class="occ">{200}</a> <span class="keyword">!</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ201 class="occ">{201}</a> <span class="keyword">in</span>(<span class="name">attackCh</span>, <span class="var">someAuls4</span>: <span class="type">AuthList</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ202 class="occ">{202}</a> <span class="keyword">new</span> <span class="name">enclaveVrfyE2KeySeed</span>: <span class="type">keyseed</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ203 class="occ">{203}</a> <span class="keyword">new</span> <span class="name">enclaveVrfyE2EcKey1</span>: <span class="type">ecskey</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ204 class="occ">{204}</a> <span class="keyword">let</span> <span class="var">@19_appLocAttRep_227</span>: <span class="type">signature</span> = <span class="fun">sign</span>(<span class="fun">LocAttRep</span>(<span class="fun">true</span>,<span class="fun">DiHeExp</span>(<span class="fun">DiHeValG</span>,<span class="name">enclaveVrfyE2EcKey1</span>),<span class="fun">HashEnclave</span>(<span class="fun">enclaveVrfy</span>),<span class="fun">emptyStr</span>),<span class="fun">sskgen</span>(<span class="name">localRepKey</span>)) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ205 class="occ">{205}</a> <span class="keyword">out</span>(<span class="name">appSvrCh</span>, <span class="var">@19_appLocAttRep_227</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ206 class="occ">{206}</a> <span class="keyword">in</span>(<span class="name">appSvrCh</span>, <span class="var">@19_svrLocAttRep_228</span>: <span class="type">signature</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ207 class="occ">{207}</a> <span class="keyword">let</span> <span class="fun">LocAttRep</span>(=<span class="fun">false</span>,<span class="var">@19_svrEcPKey_229</span>: <span class="type">ecpkey</span>,<span class="var">@19_svrEncHash_230</span>: <span class="type">enclaveHash</span>,<span class="var">@19_svrAppData_231</span>: <span class="type">bitstring</span>) = <span class="fun">getmess</span>(<span class="var">@19_svrLocAttRep_228</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ208 class="occ">{208}</a> <span class="keyword">if</span> <span class="fun">checksign</span>(<span class="fun">getmess</span>(<span class="var">@19_svrLocAttRep_228</span>),<span class="fun">spkgen</span>(<span class="name">localRepKey</span>),<span class="var">@19_svrLocAttRep_228</span>) <span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ209 class="occ">{209}</a> <span class="keyword">let</span> <span class="var">@19_locChKey_232</span>: <span class="type">key</span> = <span class="fun">EcDiHeToKey</span>(<span class="fun">DiHeExp</span>(<span class="var">@19_svrEcPKey_229</span>,<span class="name">enclaveVrfyE2EcKey1</span>)) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ210 class="occ">{210}</a> <span class="keyword">let</span> <span class="var">@19_chNonce0_233</span>: <span class="type">nonce</span> = <span class="fun">zero_nonce</span> <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ211 class="occ">{211}</a> <span class="keyword">let</span> <span class="var">@19_chNonce1_234</span>: <span class="type">nonce</span> = <span class="fun">IncrNonce</span>(<span class="var">@19_chNonce0_233</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ212 class="occ">{212}</a> <span class="keyword">new</span> <span class="name">@9_r_235</span>: <span class="type">enc_seed</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ213 class="occ">{213}</a> <span class="keyword">out</span>(<span class="name">appSvrCh</span>, <span class="fun">enc_r</span>(<span class="fun"></span>(<span class="fun">spkgen</span>(<span class="name">enclaveVrfyE2KeySeed</span>),<span class="var">someAuls4</span>),<span class="fun"></span>(<span class="fun">false</span>,<span class="var">@19_chNonce0_233</span>),<span class="var">@19_locChKey_232</span>,<span class="name">@9_r_235</span>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ214 class="occ">{214}</a> <span class="keyword">in</span>(<span class="name">appSvrCh</span>, <span class="var">@19_appCertCipher_236</span>: <span class="type">ciphertext</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ215 class="occ">{215}</a> <span class="keyword">let</span> <span class="fun">sinjbot</span>(<span class="fun"></span>(<span class="var">@19_svrCert_237</span>: <span class="type">signature</span>,<span class="var">@19_appCert_238</span>: <span class="type">signature</span>)) = <span class="fun">dec</span>(<span class="var">@19_appCertCipher_236</span>,<span class="fun"></span>(<span class="fun">true</span>,<span class="var">@19_chNonce1_234</span>),<span class="var">@19_locChKey_232</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ216 class="occ">{216}</a> <span class="keyword">in</span>(<span class="name">vrfyCh</span>, <span class="fun"></span>(<span class="var">@19_peerNameSign_239</span>: <span class="type">signature</span>,<span class="var">@19_peerSvrCert_240</span>: <span class="type">signature</span>,<span class="var">@19_peerAppCert_241</span>: <span class="type">signature</span>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ217 class="occ">{217}</a> <span class="keyword">let</span> <span class="fun">DecentSvrSignin</span>(<span class="var">@19_peerSvrSPKey_242</span>: <span class="type">spkey</span>,<span class="var">@19_peerSvrIasRep_243</span>: <span class="type">signature</span>) = <span class="fun">getmess</span>(<span class="var">@19_peerSvrCert_240</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ218 class="occ">{218}</a> <span class="keyword">let</span> <span class="fun">IasRep2Signin</span>(=<span class="fun">true</span>,<span class="var">@19_peerSvrIasEncHash_244</span>: <span class="type">enclaveHash</span>,=<span class="var">@19_peerSvrSPKey_242</span>) = <span class="fun">getmess</span>(<span class="var">@19_peerSvrIasRep_243</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ219 class="occ">{219}</a> <span class="keyword">let</span> <span class="fun">DecentAppSignin</span>(=<span class="fun">HashEnclave</span>(<span class="fun">enclaveD</span>),<span class="var">@19_peerAppSPKey_245</span>: <span class="type">spkey</span>,<span class="var">@19_peerAppAuLs_246</span>: <span class="type">AuthList</span>) = <span class="fun">getmess</span>(<span class="var">@19_peerAppCert_241</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ220 class="occ">{220}</a> <span class="keyword">let</span> <span class="var">@19_peerName_247</span>: <span class="type">bitstring</span> = <span class="fun">getmess</span>(<span class="var">@19_peerNameSign_239</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ221 class="occ">{221}</a> <span class="keyword">if</span> <span class="pred">AuthListIsIn</span>(<span class="fun">AuthListNewItem</span>(<span class="var">@19_peerSvrIasEncHash_244</span>,<span class="fun">decentSvrName</span>),<span class="var">someAuls4</span>) <span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ222 class="occ">{222}</a> <span class="keyword">if</span> (<span class="fun">checksign</span>(<span class="fun">getmess</span>(<span class="var">@19_peerSvrIasRep_243</span>),<span class="var">pub_iasRepSPKey</span>,<span class="var">@19_peerSvrIasRep_243</span>) <span class="fun">&amp;&amp;</span> (<span class="fun">checksign</span>(<span class="fun">getmess</span>(<span class="var">@19_peerSvrCert_240</span>),<span class="var">@19_peerSvrSPKey_242</span>,<span class="var">@19_peerSvrCert_240</span>) <span class="fun">&amp;&amp;</span> (<span class="fun">checksign</span>(<span class="fun">getmess</span>(<span class="var">@19_peerAppCert_241</span>),<span class="var">@19_peerSvrSPKey_242</span>,<span class="var">@19_peerAppCert_241</span>) <span class="fun">&amp;&amp;</span> (<span class="fun">checksign</span>(<span class="fun">getmess</span>(<span class="var">@19_peerNameSign_239</span>),<span class="var">@19_peerAppSPKey_245</span>,<span class="var">@19_peerNameSign_239</span>) <span class="fun">&amp;&amp;</span> (<span class="var">someAuls4</span> <span class="fun">=</span> <span class="var">@19_peerAppAuLs_246</span>))))) <span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ223 class="occ">{223}</a> <span class="keyword">let</span> <span class="var">@19_vPrCert_248</span>: <span class="type">signature</span> = <span class="fun">sign</span>(<span class="fun">@19_DecentVrfyAppsignin</span>(<span class="fun">enclaveEName</span>,<span class="fun">HashEnclave</span>(<span class="fun">enclaveD</span>),<span class="var">@19_peerAppSPKey_245</span>,<span class="var">@19_peerAppAuLs_246</span>),<span class="fun">sskgen</span>(<span class="name">enclaveVrfyE2KeySeed</span>)) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ224 class="occ">{224}</a> <span class="keyword">event</span> <span class="fun">DecentVrfyIssueCert</span>(<span class="fun">enclaveVrfy</span>,<span class="var">@19_peerSvrIasEncHash_244</span>,<span class="fun">enclaveEName</span>,<span class="fun">HashEnclave</span>(<span class="fun">enclaveD</span>),<span class="var">@19_peerAppSPKey_245</span>,<span class="var">someAuls4</span>,<span class="var">@19_peerAppAuLs_246</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ225 class="occ">{225}</a> <span class="keyword">out</span>(<span class="name">vrfyCh</span>, <span class="fun"></span>(<span class="var">@19_svrCert_237</span>,<span class="var">@19_appCert_238</span>,<span class="var">@19_vPrCert_248</span>))<br>
&nbsp;&nbsp;&nbsp;&nbsp;) | (<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ226 class="occ">{226}</a> <span class="keyword">!</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ227 class="occ">{227}</a> <span class="keyword">in</span>(<span class="name">attackCh</span>, <span class="var">someAuls5</span>: <span class="type">AuthList</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ228 class="occ">{228}</a> <span class="keyword">new</span> <span class="name">enclaveVrfyF2KeySeed</span>: <span class="type">keyseed</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ229 class="occ">{229}</a> <span class="keyword">new</span> <span class="name">enclaveVrfyF2EcKey1</span>: <span class="type">ecskey</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ230 class="occ">{230}</a> <span class="keyword">let</span> <span class="var">@19_appLocAttRep_249</span>: <span class="type">signature</span> = <span class="fun">sign</span>(<span class="fun">LocAttRep</span>(<span class="fun">true</span>,<span class="fun">DiHeExp</span>(<span class="fun">DiHeValG</span>,<span class="name">enclaveVrfyF2EcKey1</span>),<span class="fun">HashEnclave</span>(<span class="fun">enclaveVrfy</span>),<span class="fun">emptyStr</span>),<span class="fun">sskgen</span>(<span class="name">localRepKey</span>)) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ231 class="occ">{231}</a> <span class="keyword">out</span>(<span class="name">appSvrCh</span>, <span class="var">@19_appLocAttRep_249</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ232 class="occ">{232}</a> <span class="keyword">in</span>(<span class="name">appSvrCh</span>, <span class="var">@19_svrLocAttRep_250</span>: <span class="type">signature</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ233 class="occ">{233}</a> <span class="keyword">let</span> <span class="fun">LocAttRep</span>(=<span class="fun">false</span>,<span class="var">@19_svrEcPKey_251</span>: <span class="type">ecpkey</span>,<span class="var">@19_svrEncHash_252</span>: <span class="type">enclaveHash</span>,<span class="var">@19_svrAppData_253</span>: <span class="type">bitstring</span>) = <span class="fun">getmess</span>(<span class="var">@19_svrLocAttRep_250</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ234 class="occ">{234}</a> <span class="keyword">if</span> <span class="fun">checksign</span>(<span class="fun">getmess</span>(<span class="var">@19_svrLocAttRep_250</span>),<span class="fun">spkgen</span>(<span class="name">localRepKey</span>),<span class="var">@19_svrLocAttRep_250</span>) <span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ235 class="occ">{235}</a> <span class="keyword">let</span> <span class="var">@19_locChKey_254</span>: <span class="type">key</span> = <span class="fun">EcDiHeToKey</span>(<span class="fun">DiHeExp</span>(<span class="var">@19_svrEcPKey_251</span>,<span class="name">enclaveVrfyF2EcKey1</span>)) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ236 class="occ">{236}</a> <span class="keyword">let</span> <span class="var">@19_chNonce0_255</span>: <span class="type">nonce</span> = <span class="fun">zero_nonce</span> <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ237 class="occ">{237}</a> <span class="keyword">let</span> <span class="var">@19_chNonce1_256</span>: <span class="type">nonce</span> = <span class="fun">IncrNonce</span>(<span class="var">@19_chNonce0_255</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ238 class="occ">{238}</a> <span class="keyword">new</span> <span class="name">@9_r_257</span>: <span class="type">enc_seed</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ239 class="occ">{239}</a> <span class="keyword">out</span>(<span class="name">appSvrCh</span>, <span class="fun">enc_r</span>(<span class="fun"></span>(<span class="fun">spkgen</span>(<span class="name">enclaveVrfyF2KeySeed</span>),<span class="var">someAuls5</span>),<span class="fun"></span>(<span class="fun">false</span>,<span class="var">@19_chNonce0_255</span>),<span class="var">@19_locChKey_254</span>,<span class="name">@9_r_257</span>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ240 class="occ">{240}</a> <span class="keyword">in</span>(<span class="name">appSvrCh</span>, <span class="var">@19_appCertCipher_258</span>: <span class="type">ciphertext</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ241 class="occ">{241}</a> <span class="keyword">let</span> <span class="fun">sinjbot</span>(<span class="fun"></span>(<span class="var">@19_svrCert_259</span>: <span class="type">signature</span>,<span class="var">@19_appCert_260</span>: <span class="type">signature</span>)) = <span class="fun">dec</span>(<span class="var">@19_appCertCipher_258</span>,<span class="fun"></span>(<span class="fun">true</span>,<span class="var">@19_chNonce1_256</span>),<span class="var">@19_locChKey_254</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ242 class="occ">{242}</a> <span class="keyword">in</span>(<span class="name">vrfyCh</span>, <span class="fun"></span>(<span class="var">@19_peerNameSign_261</span>: <span class="type">signature</span>,<span class="var">@19_peerSvrCert_262</span>: <span class="type">signature</span>,<span class="var">@19_peerAppCert_263</span>: <span class="type">signature</span>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ243 class="occ">{243}</a> <span class="keyword">let</span> <span class="fun">DecentSvrSignin</span>(<span class="var">@19_peerSvrSPKey_264</span>: <span class="type">spkey</span>,<span class="var">@19_peerSvrIasRep_265</span>: <span class="type">signature</span>) = <span class="fun">getmess</span>(<span class="var">@19_peerSvrCert_262</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ244 class="occ">{244}</a> <span class="keyword">let</span> <span class="fun">IasRep2Signin</span>(=<span class="fun">true</span>,<span class="var">@19_peerSvrIasEncHash_266</span>: <span class="type">enclaveHash</span>,=<span class="var">@19_peerSvrSPKey_264</span>) = <span class="fun">getmess</span>(<span class="var">@19_peerSvrIasRep_265</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ245 class="occ">{245}</a> <span class="keyword">let</span> <span class="fun">DecentAppSignin</span>(=<span class="fun">HashEnclave</span>(<span class="fun">enclaveD</span>),<span class="var">@19_peerAppSPKey_267</span>: <span class="type">spkey</span>,<span class="var">@19_peerAppAuLs_268</span>: <span class="type">AuthList</span>) = <span class="fun">getmess</span>(<span class="var">@19_peerAppCert_263</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ246 class="occ">{246}</a> <span class="keyword">let</span> <span class="var">@19_peerName_269</span>: <span class="type">bitstring</span> = <span class="fun">getmess</span>(<span class="var">@19_peerNameSign_261</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ247 class="occ">{247}</a> <span class="keyword">if</span> <span class="pred">AuthListIsIn</span>(<span class="fun">AuthListNewItem</span>(<span class="var">@19_peerSvrIasEncHash_266</span>,<span class="fun">decentSvrName</span>),<span class="var">someAuls5</span>) <span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ248 class="occ">{248}</a> <span class="keyword">if</span> (<span class="fun">checksign</span>(<span class="fun">getmess</span>(<span class="var">@19_peerSvrIasRep_265</span>),<span class="var">pub_iasRepSPKey</span>,<span class="var">@19_peerSvrIasRep_265</span>) <span class="fun">&amp;&amp;</span> (<span class="fun">checksign</span>(<span class="fun">getmess</span>(<span class="var">@19_peerSvrCert_262</span>),<span class="var">@19_peerSvrSPKey_264</span>,<span class="var">@19_peerSvrCert_262</span>) <span class="fun">&amp;&amp;</span> (<span class="fun">checksign</span>(<span class="fun">getmess</span>(<span class="var">@19_peerAppCert_263</span>),<span class="var">@19_peerSvrSPKey_264</span>,<span class="var">@19_peerAppCert_263</span>) <span class="fun">&amp;&amp;</span> (<span class="fun">checksign</span>(<span class="fun">getmess</span>(<span class="var">@19_peerNameSign_261</span>),<span class="var">@19_peerAppSPKey_267</span>,<span class="var">@19_peerNameSign_261</span>) <span class="fun">&amp;&amp;</span> (<span class="var">someAuls5</span> <span class="fun">=</span> <span class="var">@19_peerAppAuLs_268</span>))))) <span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ249 class="occ">{249}</a> <span class="keyword">let</span> <span class="var">@19_vPrCert_270</span>: <span class="type">signature</span> = <span class="fun">sign</span>(<span class="fun">@19_DecentVrfyAppsignin</span>(<span class="fun">enclaveFName</span>,<span class="fun">HashEnclave</span>(<span class="fun">enclaveD</span>),<span class="var">@19_peerAppSPKey_267</span>,<span class="var">@19_peerAppAuLs_268</span>),<span class="fun">sskgen</span>(<span class="name">enclaveVrfyF2KeySeed</span>)) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ250 class="occ">{250}</a> <span class="keyword">event</span> <span class="fun">DecentVrfyIssueCert</span>(<span class="fun">enclaveVrfy</span>,<span class="var">@19_peerSvrIasEncHash_266</span>,<span class="fun">enclaveFName</span>,<span class="fun">HashEnclave</span>(<span class="fun">enclaveD</span>),<span class="var">@19_peerAppSPKey_267</span>,<span class="var">someAuls5</span>,<span class="var">@19_peerAppAuLs_268</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ251 class="occ">{251}</a> <span class="keyword">out</span>(<span class="name">vrfyCh</span>, <span class="fun"></span>(<span class="var">@19_svrCert_259</span>,<span class="var">@19_appCert_260</span>,<span class="var">@19_vPrCert_270</span>))<br>
&nbsp;&nbsp;&nbsp;&nbsp;) | (<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ252 class="occ">{252}</a> <span class="keyword">!</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ253 class="occ">{253}</a> <span class="keyword">new</span> <span class="name">malSvrKeyseed</span>: <span class="type">keyseed</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ254 class="occ">{254}</a> <span class="keyword">new</span> <span class="name">malSvrEcKey1</span>: <span class="type">ecskey</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ255 class="occ">{255}</a> <span class="keyword">out</span>(<span class="name">attackCh</span>, <span class="name">malSvrKeyseed</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ256 class="occ">{256}</a> <span class="keyword">out</span>(<span class="name">attackCh</span>, <span class="name">malSvrEcKey1</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ257 class="occ">{257}</a> <span class="keyword">let</span> <span class="var">@18_signedQuote_271</span>: <span class="type">signature</span> = <span class="fun">sign</span>(<span class="fun">EnclaveQuoteSignin</span>(<span class="fun">HashEnclave</span>(<span class="fun">malDecentSvr</span>),<span class="fun">spkgen</span>(<span class="name">malSvrKeyseed</span>)),<span class="fun">sskgen</span>(<span class="fun">encPrvsKeySeed</span>)) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ258 class="occ">{258}</a> <span class="keyword">out</span>(<span class="name">svrIasCh</span>, <span class="var">@18_signedQuote_271</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ259 class="occ">{259}</a> <span class="keyword">let</span> <span class="var">@18_svrLocAttRep_272</span>: <span class="type">signature</span> = <span class="fun">sign</span>(<span class="fun">LocAttRep</span>(<span class="fun">false</span>,<span class="fun">DiHeExp</span>(<span class="fun">DiHeValG</span>,<span class="name">malSvrEcKey1</span>),<span class="fun">HashEnclave</span>(<span class="fun">malDecentSvr</span>),<span class="fun">emptyStr</span>),<span class="fun">sskgen</span>(<span class="name">localRepKey</span>)) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ260 class="occ">{260}</a> <span class="keyword">out</span>(<span class="name">attackCh</span>, <span class="var">@18_svrLocAttRep_272</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ261 class="occ">{261}</a> <span class="keyword">let</span> <span class="var">@18_svrLocAttRepT</span>: <span class="type">signature</span> = <span class="fun">sign</span>(<span class="fun">LocAttRep</span>(<span class="fun">true</span>,<span class="fun">DiHeExp</span>(<span class="fun">DiHeValG</span>,<span class="name">malSvrEcKey1</span>),<span class="fun">HashEnclave</span>(<span class="fun">malDecentSvr</span>),<span class="fun">emptyStr</span>),<span class="fun">sskgen</span>(<span class="name">localRepKey</span>)) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ262 class="occ">{262}</a> <span class="keyword">out</span>(<span class="name">attackCh</span>, <span class="var">@18_svrLocAttRepT</span>)<br>
&nbsp;&nbsp;&nbsp;&nbsp;) | (<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ263 class="occ">{263}</a> <span class="keyword">!</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ264 class="occ">{264}</a> <span class="keyword">new</span> <span class="name">enclaveDEcKey1</span>: <span class="type">ecskey</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ265 class="occ">{265}</a> <span class="keyword">out</span>(<span class="name">attackCh</span>, <span class="name">enclaveDEcKey1</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ266 class="occ">{266}</a> <span class="keyword">let</span> <span class="var">@19_appLocAttRep_273</span>: <span class="type">signature</span> = <span class="fun">sign</span>(<span class="fun">LocAttRep</span>(<span class="fun">true</span>,<span class="fun">DiHeExp</span>(<span class="fun">DiHeValG</span>,<span class="name">enclaveDEcKey1</span>),<span class="fun">HashEnclave</span>(<span class="fun">enclaveD</span>),<span class="fun">emptyStr</span>),<span class="fun">sskgen</span>(<span class="name">localRepKey</span>)) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ267 class="occ">{267}</a> <span class="keyword">out</span>(<span class="name">attackCh</span>, <span class="var">@19_appLocAttRep_273</span>)<br>
&nbsp;&nbsp;&nbsp;&nbsp;)<br>
)<br>
<br>
</body>
</html>
